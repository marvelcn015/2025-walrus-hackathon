paths:
  /tee/compute:
    post:
      summary: Compute KPI with mock TEE attestation (testing endpoint)
      description: |
        Calculate cumulative KPI from financial documents with mock cryptographic attestation.

        WARNING: Currently uses MOCK TEE for testing. NOT cryptographically secure for production.

        Technical Details:
        - Processes multiple financial document types (Journal Entry, Fixed Assets, Payroll, Overhead)
        - Returns 144-byte attestation format compatible with Sui Move verification
        - Computation hash (SHA-256) included for input verification

        Supported document types:
        - Journal Entry: Sales revenue extraction
        - Fixed Assets Register: Depreciation calculation
        - Payroll Expense: Gross pay deduction
        - Overhead Report: 10% overhead allocation

        Use Cases:
        - Development and testing without real TEE infrastructure
        - Validating KPI calculation logic before production deployment
        - Frontend integration testing with attestation format

      operationId: computeKPI
      tags:
        - Nautilus
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - documents
              properties:
                documents:
                  type: array
                  description: Array of financial documents to process
                  minItems: 1
                  items:
                    type: object
                  example:
                    - journalEntryId: "JE-2025-001"
                      credits:
                        - account: "Sales Revenue"
                          amount: 50000
                    - employeeDetails: {}
                      grossPay: 20000
                operation:
                  type: string
                  enum: [simple, with_attestation]
                  default: with_attestation
                  description: |
                    simple: Calculate KPI only
                    with_attestation: Calculate with mock TEE attestation (default)
                initial_kpi:
                  type: number
                  default: 0
                  description: Initial KPI value for incremental calculations
      responses:
        '200':
          description: KPI computation successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      kpi_result:
                        type: object
                        properties:
                          kpi:
                            type: number
                          document_count:
                            type: integer
                          breakdown:
                            type: array
                            items:
                              type: object
                      attestation:
                        type: object
                        description: Mock TEE attestation metadata
                      attestation_bytes:
                        type: array
                        items:
                          type: integer
                        minItems: 144
                        maxItems: 144
                        description: 144-byte attestation for blockchain submission
                  message:
                    type: string
              example:
                success: true
                data:
                  kpi_result:
                    kpi: 30000
                    document_count: 2
                    breakdown:
                      - type: "journal_entry"
                        impact: 50000
                      - type: "payroll"
                        impact: -20000
                  attestation_bytes: [0, 1, 2, 3, ...]
                message: "KPI calculated with mock TEE attestation"
        '400':
          description: Invalid request (missing or invalid documents)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string
        '500':
          description: Internal server error during computation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string

    get:
      summary: Get TEE Compute API information
      description: Returns API documentation and usage examples for the mock TEE compute endpoint.
      operationId: getTEEComputeInfo
      tags:
        - Nautilus
      responses:
        '200':
          description: API information
          content:
            application/json:
              schema:
                type: object
                properties:
                  endpoint:
                    type: string
                  methods:
                    type: array
                    items:
                      type: string
                  description:
                    type: string
                  usage:
                    type: object
                  warning:
                    type: string
